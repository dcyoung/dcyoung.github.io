<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.26.2 by Michael Rose
  Copyright 2013-2024 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->

<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>​Stochastic Gradient Descent + ​SVM Classifier in R</title>
<meta name="description" content="Implementing Stoachastic Gradient Descent from scratch in R.">


  <meta name="author" content="David Young">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="David Young">
<meta property="og:title" content="​Stochastic Gradient Descent + ​SVM Classifier in R">
<meta property="og:url" content="https://dcyoung.github.io/pages/dcyoung/post-stochastic-gradient-descent-in-r/">


  <meta property="og:description" content="Implementing Stoachastic Gradient Descent from scratch in R.">



  <meta property="og:image" content="https://dcyoung.github.io/pages/dcyoung/images/stoachstic-gradient-descent-in-r/0.webp">





  <meta property="article:published_time" content="2016-01-05T07:00:00+07:00">



  <meta property="article:modified_time" content="2016-01-05T07:00:00+07:00">




<link rel="canonical" href="https://dcyoung.github.io/pages/dcyoung/post-stochastic-gradient-descent-in-r/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "David Young",
      "url": "https://dcyoung.github.io/pages/dcyoung/",
      "sameAs": ["https://www.linkedin.com/in/david-young-09509210a"]
    
  }
</script>






<!-- end _includes/seo.html -->


  <link href="/pages/dcyoung/feed.xml" type="application/atom+xml" rel="alternate" title="David Young Feed">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="text/javascript">
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
  
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/pages/dcyoung/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@latest/css/all.min.css"></noscript>



    <!-- start custom head snippets -->
<link rel="shortcut icon" href="/images/site/favicon.ico">
<meta name="theme-color" content="#ffffff">

<!-- end custom head snippets -->

<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML">
</script>
<meta name="google-site-verification" content="zewSCzlO5JWAuo7MV_u4VoTRLfV4lUrqwxvfo4-3Xfc" />
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({
     extensions: ["tex2jax.js"],
     jax: ["input/TeX", "output/HTML-CSS"],
     tex2jax: {
       inlineMath: [ ['$','$'], ["\\(","\\)"] ],
       displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
       processEscapes: true,
       preview: 'none'
     },
     messageStyle: 'none',
     "HTML-CSS": { availableFonts: ["TeX"] }
   });

</script>

<style>
    .bg-color-red {
        background-color: #ffebee;
    }

    .bg-color-green {
        background-color: #e8f5e9;
    }

    .bg-color-yellow {
        background-color: #fff3e0;
    }

    .bg-color-dark-green {
        background-color: #c8e6c9;
    }

    .bg-color-pink {
        background-color: #ffcdd2;
    }

    .bg-color-purple {
        background-color: #c5cae9;
    }

    .pwc-icon {
        width: 23px;
        height: 23px;
        position: relative;
        top: 5px;
        margin-right: 5px;
    }

</style>

  </head>

  <body class="layout--single wide" dir="ltr">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/pages/dcyoung/">
          David Young
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a
                href="/pages/dcyoung/archives/"
                
                
              >Posts</a>
            </li><li class="masthead__menu-item">
              <a
                href="/pages/dcyoung/about/"
                
                
              >About</a>
            </li><li class="masthead__menu-item">
              <a
                href="/pages/dcyoung/resume/"
                
                
              >Resume</a>
            </li><li class="masthead__menu-item">
              <a
                href="/pages/dcyoung/ml-practitioners-guide/"
                
                
              >ML Practitioner's Guide</a>
            </li><li class="masthead__menu-item">
              <a
                href="/pages/dcyoung/categories/"
                
                
              >Categories</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <i class="fas fa-search"></i>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  
    <div class="author__avatar">
      <a href="https://dcyoung.github.io/pages/dcyoung/">
        <img src="/pages/dcyoung/images/site/profile_artsy.webp" alt="David Young" itemprop="image" class="u-photo">
      </a>
    </div>
  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="https://dcyoung.github.io/pages/dcyoung/" itemprop="url">David Young</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>systems thinker &amp; passionate engineer</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="https://github.com/dcyoung" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/david-young-09509210a" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">Linkedin</span></a></li>
          
        
          
            <li><a href="https://www.instagram.com/cycle_shadez/" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i><span class="label">Instagram</span></a></li>
          
        
          
            <li><a href="https://www.youtube.com/channel/UClQEBd-MzkWlkjbxcsve-UA" rel="nofollow noopener noreferrer me" itemprop="sameAs"><i class="fab fa-fw fa-youtube" aria-hidden="true"></i><span class="label">YouTube</span></a></li>
          
        
          
            <li><a href="mailto:david@questionablyartificial.com" rel="nofollow noopener noreferrer me"><i class="fab fa-fw fa-envelope" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="​Stochastic Gradient Descent + ​SVM Classifier in R">
    <meta itemprop="description" content="Implementing Stoachastic Gradient Descent from scratch in R.">
    <meta itemprop="datePublished" content="2016-01-05T07:00:00+07:00">
    <meta itemprop="dateModified" content="2016-01-05T07:00:00+07:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">
            <a href="https://dcyoung.github.io/pages/dcyoung/post-stochastic-gradient-descent-in-r/" itemprop="url">​Stochastic Gradient Descent + ​SVM Classifier in R
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          7 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#dataset">Dataset</a></li><li><a href="#stochastic-gradient-descent-for-svms">Stochastic Gradient Descent for SVMs</a></li><li><a href="#results">Results</a></li><li><a href="#implementation">Implementation</a></li></ul>
            </nav>
          </aside>
        
        <h2 id="dataset">Dataset</h2>

<p>The code snippet presented here was written to deal with a collection of data on adult income hosted by the UC Irvine learning data repository. The dataset can be obtained here: <a href="​https://archive.ics.uci.edu/ml/datasets/Adult">​https://archive.ics.uci.edu/ml/datasets/Adult</a></p>

<h2 id="stochastic-gradient-descent-for-svms">Stochastic Gradient Descent for SVMs</h2>

<p>Naive Bayes classifiers are really just a decision rule that compares two products of posterior probability and cost for getting something wrong. Support Vector Machines skip some of the calculations and jump right to searching for weight values. This search requires choosing weights to minimize the cost of errors during training plus the cost of errors in the future. So, we have a complex cost function (F) and we wish to search for a set of values that will minimize that cost function. One way to search for that minimum is to start our variables at random values and take steps along an intelligent direction that will lead us to the minimum. If we imagine this cost function (F) is differentiable, a Taylor series would indicate that the negative gradient is a good search direction for the minimization of F. So we choose our search direction to be the negative gradient. Only problem is, in many cases there is too much data to compute the gradient of F. This is where stochastic gradient descent comes in.</p>

<p>Because the gradient of F is too complex to compute for high dimensional space with many training examples, we’ll turn to stochastic gradient descent. What we’ll do is randomly pick 1 example at a time of the N total training examples. We’ll compute the gradient of the cost function for that example alone and report that vector as the search direction. The computation of this gradient isn’t too intensive because its only 1 example. We’ll then take a step in that direction of a certain length and repeat the process using a new random training example. The key here is that the EXPECTED VALUE of these individual search directions is actually equal to the gradient of F. This is because each is being pulled from the pool of training examples that would be used to calculate the entire gradient of F. It is unlikely that any are actually the gradient, but over time the steps will average out to the right direction even if certain steps are in the wrong direction.</p>

<p>How far should we step in the computed direction? Well we aren’t positive that the direction is correct, but we know on average the chosen directions will lead us along the gradient. To deal with this early uncertainty but later confidence, we’ll use a series of step lengths that decrease over time. Mathematically this equates to maintaining two properties. 1. The limit of the last step as the number of steps approaches infinity should be zero. And 2. The limit of the summation of all the steps as the number of steps approaches infinity should be infinity.  Why do we maintain these properties? Because presumably if you’ve been moving for a while, you are probably going in the right direction. If you haven’t been moving for a while, you might not have accumulated enough average movement in the right direction, so you should take BIG steps in case you need to make up for the accumulated error. The # of steps are divvied up into different groups called epochs, each with a smaller step length. For example, if you had 1000 steps placed into 10 epochs, you would make 100 steps at every one of 10 different step lengths.</p>

<h2 id="results">Results</h2>

<p>​An estimate of the accuracy of the best classifier on the held out (test) data was .814, the mean of 5 different runs on the algorithm. The regularization constant did not seem to greatly affect model accuracy (particularly on the test set) considering the scale at which it varied (factor of 1000).  High lambda values (.1 and 1), however, led to loss of accuracy on the validation set, because they allowed for more examples to be misclassified or fall within the margin. Whereas small lambda values could improve accuracy on the training examples but decrease the model’s ability to generalize to new data.</p>

<figure>
<img src="/images/stoachstic-gradient-descent-in-r/0.webp" />
<figcaption>accuracy of the model on the randomly selected epoch validation set as a function of increasing step number and the regularization constant lambda</figcaption>
</figure>

<figure>
<img src="/images/stoachstic-gradient-descent-in-r/1.webp" />
<figcaption>accuracy of the model on the overall validation set as a function of increasing step number and the regularization constant lambda</figcaption>
</figure>

<h2 id="implementation">Implementation</h2>

<p>The goal here was to write a program from scratch to train a support vector machine on this data using stochastic gradient descent. The final Support Vector Classifier classifies the income bracket (less than or greater than $50k) of an example adult. Only continuous attributes from the dataset were used during training. The program searches for an appropriate value of the regularization constant among a few order of magnitude  λ = [1e − 3, 1e − 2, 1e − 1, 1]. A validation set is used for this search. The program uses 100 epochs, each with 500 steps. The step size is constant for each step in a given epoch, but decreases as the epoch increases. In each epoch, the program separate s out 50 training examples at random for evaluation. Accuracy of the current classifier is computed on the set held out for the epoch every 30 steps.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#------------------------------------- SETUP WORK --------------------------------------</span><span class="w">
</span><span class="c1">#clear the workspace and console</span><span class="w">
</span><span class="n">rm</span><span class="p">(</span><span class="n">list</span><span class="o">=</span><span class="n">ls</span><span class="p">())</span><span class="w">
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"\014"</span><span class="p">)</span><span class="w"> </span><span class="c1">#code to send ctrl+L to the console and therefore clear the screen</span><span class="w">
 
</span><span class="c1">#setup working directory </span><span class="w">
</span><span class="n">setwd</span><span class="p">(</span><span class="s1">'~/DirectoryNameGoesHere'</span><span class="p">)</span><span class="w">
</span><span class="c1">#import libraries to help with data splitting/partitioning, </span><span class="w">
</span><span class="c1">#cross validation and easy classifier construction</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">klaR</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">caret</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span><span class="w">
 
 
 
</span><span class="c1">#------------------------------------- Acquire and Pre-Process Data------------------------------</span><span class="w">
 
</span><span class="c1">#read all the data into a single table</span><span class="w">
</span><span class="n">allData</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s1">'adult.txt'</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> 
 
</span><span class="c1">#grab the labels from the main data file... use as.factor to make </span><span class="w">
</span><span class="c1">#the format comptabile with future functions to be used</span><span class="w">
</span><span class="n">labels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">allData</span><span class="p">[,</span><span class="m">15</span><span class="p">])</span><span class="w">
 
 
</span><span class="c1">#grab the features from the main data file, removing the labels </span><span class="w">
</span><span class="c1">#assume no data is missing... ie: ignore missing values without noting them as NA</span><span class="w">
</span><span class="n">allFeatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allData</span><span class="p">[,</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="m">15</span><span class="p">)]</span><span class="w">
 
</span><span class="c1">#the continous features are in cols 1,3,5,11,12,13</span><span class="w">
</span><span class="n">continuousFeatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">allFeatures</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">11</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">13</span><span class="p">)]</span><span class="w">
 
</span><span class="c1">#there are no ? (missing feature) for any of the continuous feature, so this modification is irrelevant</span><span class="w">
</span><span class="c1">#adjust the features such that a 0 is reported as "NA"</span><span class="w">
</span><span class="c1">#for (f in c(1,2,3,4,5,6))</span><span class="w">
</span><span class="c1">#{</span><span class="w">
</span><span class="c1">#  #determine which examples had a 0 for this feature (ie: unknown value)</span><span class="w">
</span><span class="c1">#  examplesMissingFeatureF &lt;- continuousFeatures[, f] == ?</span><span class="w">
</span><span class="c1">#  #replace all these missing values with an NA</span><span class="w">
</span><span class="c1">#  continuousFeatures[examplesMissingFeatureF, f] = NA</span><span class="w">
</span><span class="c1">#}</span><span class="w">
</span><span class="c1">#remove any example with an NA</span><span class="w">
</span><span class="c1">#continuousFeatures[complete.cases(continuousFeatures),]</span><span class="w">
 
</span><span class="c1">#normalize the features (mean center and scale so that variance = 1 i.e. convert to z scores):</span><span class="w">
 
</span><span class="n">continuousFeatures</span><span class="o">&lt;-</span><span class="n">scale</span><span class="p">(</span><span class="n">continuousFeatures</span><span class="p">)</span><span class="w">
 
</span><span class="c1">#convert labels into 1 or -1</span><span class="w">
</span><span class="n">labels.n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">labels</span><span class="p">));</span><span class="w">
</span><span class="n">labels.n</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="s2">" &lt;=50K"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">;</span><span class="w">
</span><span class="n">labels.n</span><span class="p">[</span><span class="n">labels</span><span class="o">==</span><span class="s2">" &gt;50K"</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w">
</span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">labels.n</span><span class="p">;</span><span class="w">
</span><span class="n">rm</span><span class="p">(</span><span class="n">labels.n</span><span class="p">);</span><span class="w">
 
 
</span><span class="c1">#Separate the resulting dataset randomly</span><span class="w">
</span><span class="c1">#break off 80% for training examples</span><span class="w">
</span><span class="n">trainingData</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">createDataPartition</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="m">.8</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">trainingFeatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">continuousFeatures</span><span class="p">[</span><span class="n">trainingData</span><span class="p">,]</span><span class="w">
</span><span class="n">trainingLabels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">labels</span><span class="p">[</span><span class="n">trainingData</span><span class="p">]</span><span class="w">
 
 
</span><span class="c1">#Of the remaining 20%, half become testing exmaples and half become validation examples</span><span class="w">
</span><span class="n">remainingLabels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="n">trainingData</span><span class="p">]</span><span class="w">
</span><span class="n">remainingFeatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">continuousFeatures</span><span class="p">[</span><span class="o">-</span><span class="n">trainingData</span><span class="p">,]</span><span class="w">
 
</span><span class="n">testingData</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">createDataPartition</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">remainingLabels</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="m">.5</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">testingLabels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">remainingLabels</span><span class="p">[</span><span class="n">testingData</span><span class="p">]</span><span class="w">
</span><span class="n">testingFeatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">remainingFeatures</span><span class="p">[</span><span class="n">testingData</span><span class="p">,]</span><span class="w">
 
</span><span class="n">validationLabels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">remainingLabels</span><span class="p">[</span><span class="o">-</span><span class="n">testingData</span><span class="p">]</span><span class="w">
</span><span class="n">validationFeatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">remainingFeatures</span><span class="p">[</span><span class="o">-</span><span class="n">testingData</span><span class="p">,]</span><span class="w">
 
 
 
</span><span class="c1">#------------------------------------- DEFINE AN ACCURACY MEASURE ----------------------------</span><span class="w">
</span><span class="n">getAccuracy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">features</span><span class="p">,</span><span class="n">labels</span><span class="p">){</span><span class="w">
  </span><span class="n">estFxn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">features</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
  </span><span class="n">predictedLabels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">labels</span><span class="p">));</span><span class="w">
  </span><span class="n">predictedLabels</span><span class="w"> </span><span class="p">[</span><span class="n">estFxn</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="w"> </span><span class="p">;</span><span class="w">
  </span><span class="n">predictedLabels</span><span class="w"> </span><span class="p">[</span><span class="n">estFxn</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">;</span><span class="w">
 
  </span><span class="nf">return</span><span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">predictedLabels</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">labels</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span><span class="w">
</span><span class="p">}</span><span class="w">
 
 
 
</span><span class="c1">#------------------------------------- SETUP Classifier --------------------------------------</span><span class="w">
</span><span class="n">numEpochs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">;</span><span class="w">
</span><span class="n">numStepsPerEpoch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">500</span><span class="p">;</span><span class="w">
</span><span class="n">nStepsPerPlot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">;</span><span class="w">
 
 
</span><span class="n">evalidationSetSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">;</span><span class="w">
 
</span><span class="n">c1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="c1">#set "a" for determining steplength</span><span class="w">
</span><span class="n">c2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="c1">#set "b" for determining steplength</span><span class="w">
</span><span class="n">lambda_vals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.001</span><span class="p">,</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">);</span><span class="w">
</span><span class="n">bestAccuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w">
</span><span class="n">accMat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">numStepsPerEpoch</span><span class="o">/</span><span class="n">nStepsPerPlot</span><span class="p">)</span><span class="o">*</span><span class="n">numEpochs</span><span class="m">+1</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">lambda_vals</span><span class="p">));</span><span class="w"> </span><span class="c1">#vector for storing accuracy for each epoch</span><span class="w">
</span><span class="n">accMatv</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">numStepsPerEpoch</span><span class="o">/</span><span class="n">nStepsPerPlot</span><span class="p">)</span><span class="o">*</span><span class="n">numEpochs</span><span class="m">+1</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">lambda_vals</span><span class="p">));</span><span class="w"> </span><span class="c1">#accuracy on validation set (not epoch validation set)</span><span class="w">
 
</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">){</span><span class="w">
  </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda_vals</span><span class="p">[</span><span class="n">i</span><span class="p">];</span><span class="w">
  </span><span class="n">accMatRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w">
  </span><span class="n">accMatCol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"> </span><span class="c1">#changes with the lambda</span><span class="w">
 
  </span><span class="c1">#set a and b to 0 initially:</span><span class="w">
  </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="n">ncol</span><span class="p">(</span><span class="n">continuousFeatures</span><span class="p">));</span><span class="w">
  </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w">
 
  </span><span class="n">stepIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w">
 
  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">numEpochs</span><span class="p">){</span><span class="w">
 
    </span><span class="c1">#divide into training and validation set for epoch (validation set size = evalidationSetSize -&gt; 50 datapoints):</span><span class="w">
    </span><span class="n">etrainingData</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">createDataPartition</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">trainingLabels</span><span class="p">,</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">evalidationSetSize</span><span class="o">/</span><span class="nf">length</span><span class="p">(</span><span class="n">trainingLabels</span><span class="p">)),</span><span class="w"> </span><span class="n">list</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
 
    </span><span class="n">etrainingFeatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trainingFeatures</span><span class="p">[</span><span class="n">etrainingData</span><span class="p">,]</span><span class="w">
    </span><span class="n">etrainingLabels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trainingLabels</span><span class="p">[</span><span class="n">etrainingData</span><span class="p">]</span><span class="w">
 
    </span><span class="n">evalidationFeatures</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trainingFeatures</span><span class="p">[</span><span class="o">-</span><span class="n">etrainingData</span><span class="p">,]</span><span class="w">
    </span><span class="n">evalidationLabels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">trainingLabels</span><span class="p">[</span><span class="o">-</span><span class="n">etrainingData</span><span class="p">]</span><span class="w">
 
    </span><span class="c1">#set the steplength (eta)</span><span class="w">
    </span><span class="n">steplength</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">c1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c2</span><span class="p">);</span><span class="w">
 
    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">step</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">numStepsPerEpoch</span><span class="p">){</span><span class="w">
      </span><span class="n">stepIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stepIndex</span><span class="m">+1</span><span class="p">;</span><span class="w">
      </span><span class="n">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample.int</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">etrainingFeatures</span><span class="p">),</span><span class="m">1</span><span class="p">);</span><span class="w">
      </span><span class="n">xk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">etrainingFeatures</span><span class="p">[</span><span class="n">index</span><span class="p">,];</span><span class="w">
      </span><span class="n">yk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">etrainingLabels</span><span class="p">[</span><span class="n">index</span><span class="p">];</span><span class="w">
 
      </span><span class="n">costfxn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yk</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">xk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">);</span><span class="w"> </span><span class="c1">#not actually the cost function!</span><span class="w">
 
      </span><span class="k">if</span><span class="p">(</span><span class="n">costfxn</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">1</span><span class="p">){</span><span class="w">
 
        </span><span class="n">a_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w">
        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">steplength</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a_dir</span><span class="p">;</span><span class="w">
        </span><span class="c1">#b = b</span><span class="w">
 
      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
 
        </span><span class="n">a_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lambda</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">yk</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xk</span><span class="p">);</span><span class="w">
        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">steplength</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a_dir</span><span class="p">;</span><span class="w">
        </span><span class="n">b_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="n">yk</span><span class="w">
        </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">steplength</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">b_dir</span><span class="p">);</span><span class="w">
 
      </span><span class="p">}</span><span class="w">
 
 
      </span><span class="c1">#log the accuracy</span><span class="w">
      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">stepIndex</span><span class="w"> </span><span class="o">%%</span><span class="w"> </span><span class="n">nStepsPerPlot</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">){</span><span class="c1">#30){</span><span class="w">
        </span><span class="n">accMat</span><span class="p">[</span><span class="n">accMatRow</span><span class="p">,</span><span class="n">accMatCol</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAccuracy</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">evalidationFeatures</span><span class="p">,</span><span class="n">evalidationLabels</span><span class="p">);</span><span class="w">
        </span><span class="n">accMatv</span><span class="p">[</span><span class="n">accMatRow</span><span class="p">,</span><span class="n">accMatCol</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAccuracy</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">validationFeatures</span><span class="p">,</span><span class="n">validationLabels</span><span class="p">);</span><span class="w">
        </span><span class="n">accMatRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accMatRow</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w">
      </span><span class="p">}</span><span class="w">
 
    </span><span class="p">}</span><span class="w">
 
  </span><span class="p">}</span><span class="w">
 
  </span><span class="n">tempAccuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAccuracy</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">validationFeatures</span><span class="p">,</span><span class="n">validationLabels</span><span class="p">)</span><span class="w">
  </span><span class="n">print</span><span class="p">(</span><span class="n">str_c</span><span class="p">(</span><span class="s2">"tempAcc = "</span><span class="p">,</span><span class="w"> </span><span class="n">tempAccuracy</span><span class="p">,</span><span class="s2">" and bestAcc = "</span><span class="p">,</span><span class="w"> </span><span class="n">bestAccuracy</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">
  </span><span class="k">if</span><span class="p">(</span><span class="n">tempAccuracy</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">bestAccuracy</span><span class="p">){</span><span class="w">
    </span><span class="n">bestAccuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tempAccuracy</span><span class="w">
    </span><span class="n">best_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span><span class="w">
    </span><span class="n">best_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span><span class="w">
    </span><span class="n">best_lambdaIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w">
  </span><span class="p">}</span><span class="w">
 
</span><span class="p">}</span><span class="w">
 
 
</span><span class="n">getAccuracy</span><span class="p">(</span><span class="n">best_a</span><span class="p">,</span><span class="n">best_b</span><span class="p">,</span><span class="w"> </span><span class="n">testingFeatures</span><span class="p">,</span><span class="w"> </span><span class="n">testingLabels</span><span class="p">)</span><span class="w">
 
 
</span><span class="c1">#Plot the accuracy during training</span><span class="w">
</span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="s2">"blue"</span><span class="p">,</span><span class="s2">"green"</span><span class="p">,</span><span class="s2">"black"</span><span class="p">);</span><span class="w">
</span><span class="n">xaxislabel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Step"</span><span class="p">;</span><span class="w">
</span><span class="n">yaxislabels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Accuracy on Randomized Epoch Validation Set"</span><span class="p">,</span><span class="s2">"Accuracy on Validation Set"</span><span class="p">);</span><span class="w">
</span><span class="n">title</span><span class="o">=</span><span class="s2">"Accuracy as a Function of Step and Lambda"</span><span class="p">;</span><span class="w">
</span><span class="n">ylims</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">);</span><span class="w">
 
</span><span class="n">stepValues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">15000</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="m">500</span><span class="p">)</span><span class="w">
 
</span><span class="n">mats</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="nf">list</span><span class="p">(</span><span class="n">accMat</span><span class="p">,</span><span class="n">accMatv</span><span class="p">);</span><span class="w">
 
 
</span><span class="k">for</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">mats</span><span class="p">)){</span><span class="w">
 
  </span><span class="n">mat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mats</span><span class="p">[[</span><span class="n">j</span><span class="p">]];</span><span class="w">
 
  </span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">){</span><span class="w">
 
   </span><span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">){</span><span class="w">
     </span><span class="n">plot</span><span class="p">(</span><span class="n">stepValues</span><span class="p">,</span><span class="w"> </span><span class="n">mat</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">500</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">15000</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="n">ylims</span><span class="p">,</span><span class="w">
         </span><span class="n">col</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">xlab</span><span class="o">=</span><span class="n">xaxislabel</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="n">yaxislabels</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">main</span><span class="o">=</span><span class="n">title</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="p">{</span><span class="w">
      </span><span class="n">lines</span><span class="p">(</span><span class="n">stepValues</span><span class="p">,</span><span class="w"> </span><span class="n">mat</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">500</span><span class="p">,</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">15000</span><span class="p">),</span><span class="w"> </span><span class="n">ylim</span><span class="o">=</span><span class="n">ylims</span><span class="p">,</span><span class="w">
          </span><span class="n">col</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">xlab</span><span class="o">=</span><span class="n">xaxislabel</span><span class="p">,</span><span class="n">ylab</span><span class="o">=</span><span class="n">yaxislabels</span><span class="p">[</span><span class="n">j</span><span class="p">],</span><span class="n">main</span><span class="o">=</span><span class="n">title</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
   </span><span class="n">Sys.sleep</span><span class="p">(</span><span class="m">1</span><span class="p">);</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">legend</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">10000</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="m">.5</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"lambda=.001"</span><span class="p">,</span><span class="s2">"lambda=.01"</span><span class="p">,</span><span class="s2">"lambda=.1"</span><span class="p">,</span><span class="s2">"lambda=1"</span><span class="p">),</span><span class="n">fill</span><span class="o">=</span><span class="n">colors</span><span class="p">);</span><span class="w">
 
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        


  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/pages/dcyoung/categories/#ai" class="page__taxonomy-item p-category" rel="tag">ai</a><span class="sep">, </span>
    
      <a href="/pages/dcyoung/categories/#machine-learning" class="page__taxonomy-item p-category" rel="tag">machine learning</a><span class="sep">, </span>
    
      <a href="/pages/dcyoung/categories/#school-project" class="page__taxonomy-item p-category" rel="tag">school project</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2016-01-05">January 5, 2016</time></p>

      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?text=%E2%80%8BStochastic+Gradient+Descent+%2B+%E2%80%8BSVM+Classifier+in+R%20https%3A%2F%2Fdcyoung.github.io%2Fpages%2Fdcyoung%2Fpost-stochastic-gradient-descent-in-r%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdcyoung.github.io%2Fpages%2Fdcyoung%2Fpost-stochastic-gradient-descent-in-r%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://dcyoung.github.io/pages/dcyoung/post-stochastic-gradient-descent-in-r/" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/pages/dcyoung/post-laplacian-blob-detector/" class="pagination--pager" title="Laplacian Blob Detector
">Previous</a>
    
    
      <a href="/pages/dcyoung/post-comparing-classifiers-in-r/" class="pagination--pager" title="Comparing Classifiers in R
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Comments</h4>
      <section id="utterances-comments"></section>
    
</div>

    
  </article>

  
  
    
<div class="page__related">
  
  <h2 class="page__related-title">You May Also Enjoy</h2>
  <div class="grid__wrapper">
    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/pages/dcyoung/images/r3f-nn-visualizer/preview.webp" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/pages/dcyoung/post-r3f-nn-visualizer/" rel="permalink">Interactive Neural Network Visualizer
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">An interactive Neural Network visualization built w/ modern web technologies including tensorflow.js and react-three-fiber.
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/pages/dcyoung/images/mmle-scores/softmax.webp" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/pages/dcyoung/post-mmle-scores/" rel="permalink">Practical ML: Detecting Out-of-Distribution Data
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Detecting out of distribution samples using
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/pages/dcyoung/images/gh-pages-staging-deployments/preview.webp" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/pages/dcyoung/post-gh-pages-staging-deployments/" rel="permalink">Automating Free Staging Deployments for Github Pages
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Automating free staging deployments for Github Pages using Github Actions.
</p>
  </article>
</div>

    
      
      



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/pages/dcyoung/images/clustering-custom-distance/haversine.webp" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/pages/dcyoung/post-clustering-custom-distance/" rel="permalink">Performant Clustering of Geo Coordinates w/ Custom Distance Functions
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Implementing vectorized clustering methods for distance metrics unsupported by common libraries.
</p>
  </article>
</div>

    
  </div>
</div>

  
  
</div>

      
    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';" role="search">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://github.com/dcyoung" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://www.instagram.com/cycle_shadez/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-instagram" aria-hidden="true"></i> Instagram</a></li>
        
      
    

    
      <li><a href="/pages/dcyoung/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2024 <a href="https://dcyoung.github.io">David Young</a>. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/jekyll-themes/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/pages/dcyoung/assets/js/main.min.js"></script>




<script src="/pages/dcyoung/assets/js/lunr/lunr.min.js"></script>
<script src="/pages/dcyoung/assets/js/lunr/lunr-store.js"></script>
<script src="/pages/dcyoung/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8LFRSKS1E8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8LFRSKS1E8', { 'anonymize_ip': false});
</script>






    <script>
  'use strict';

  (function() {
    var commentContainer = document.querySelector('#utterances-comments');

    if (!commentContainer) {
      return;
    }

    var script = document.createElement('script');
    script.setAttribute('src', 'https://utteranc.es/client.js');
    script.setAttribute('repo', 'dcyoung/dcyoung.github.io');
    script.setAttribute('issue-term', 'pathname');
    script.setAttribute('label', 'comment');
    script.setAttribute('theme', 'github-light');
    script.setAttribute('crossorigin', 'anonymous');

    commentContainer.appendChild(script);
  })();
</script>

  




  </body>
</html>
